<!DOCTYPE html>
<html lang="en-us"><head>
    <meta charset="UTF-8">
    <title>Kodama D3js Tooltip by DarkMarmot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">

</head>
<body>
<section class="page-header">

    <h1 class="project-name">Kodama</h1>
    <h2 class="project-tagline" style="
    /* max-width: 60%; */
    /* text-align: center; */
">Fast and Friendly D3 Tooltips</h2>
    <a href="https://github.com/DarkMarmot/kodama" class="btn">View on GitHub</a>
    <a href="https://github.com/DarkMarmot/kodama/zipball/master" class="btn">Download .zip</a>
    <a href="https://github.com/DarkMarmot/kodama/tarball/master" class="btn">Download .tar.gz</a>


</section>


<section class="main-content">
    <div style="position: absolute;width: 100%;height:2px; */display: flex;left: 0;">
        <img id="crossguy" src="assets/crossguy.png" width="141" height="241" class="left_guy" style="
    position: absolute;
                                                                                top: -17.5rem;

">
        <img id="kneeguy" src="assets/kneeguy.png" class="right_guy" width="152" height="211" style="position: absolute;top: -13.8rem;">
    </div>
    <h3>
        <a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tooltips for D3 Data Visualizations.</h3>

    <p>Kodama is a D3-based tooltip system designed to be simple, fast and small with a fluent API. Tooltips are evaluated in a lazy fashion, allowing thousands to potentially coexist (virtually) in the same context without suffering a performance hit.
        It can be styled without CSS classes (which I view as terribly heretical global variables for any large, modular application). And it can support a preferred directional 'gravity' that will adjust itself so as to stay on the screen.</p>

    <p>It can be used across an entire site for consistency, but integrates canonically with D3's API. If using jQuery in addition to D3, you can include a tiny plugin to add tooltips to any jQuery selection.</p>

    <p>Full API documentation can be found at the <a style="color: #13C6E9;" href="https://github.com/DarkMarmot/kodama">GitHub page</a>.</p>

    <h3>
        <a class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Voronoi Example</h3>

    <div>
        <svg id="svg_demo" height="100%" width="100%" viewBox="0 0 1000 600" preserveAspectRatio="none">
        </svg>
    </div>

    <p/>
    <p/>

</section>

<script src="js/d3.min.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/kodama.js"></script>

<script>

    $(function(){


        $('#crossguy').kodama_tooltip({title: 'This tooltip was invoked via <b style="color: #7BD9E0;">jQuery</b>', gravity: 'southeast', distance: 50});

        var svg = d3.select('#svg_demo');

        var nodeLayer = svg.append('g');
        var voronoiLayer = svg.append('g');

        var nodes = d3
                .range(150)
                .reverse()
                .map(function(n) {
                    return {
                        name: n,
                        hue: Math.random() * 80 + 180,
                        radius: (n *.4 + 2),
                        cx: Math.random() * 950 + 25,
                        cy: Math.random() * 550 + 25,
                        alpha: (1.0 - (n / 150.0)) *.8
                    }
                }
        );

        var voronoi = d3.geom.voronoi()
                .x(function(d) { return d.cx; })
                .y(function(d) { return d.cy; })
                .clipExtent([[0, 0], [1000, 600]]);

        var voronoiData = voronoi(nodes);

        nodes.forEach(function(d, i){ d.voronoiData = voronoiData[i];})

        var makeTipData = function(d, i){
            return {
                title: 'This is Kodama Node #' + i,
                items: [
                    { title: 'Hue', value: d3.format(',d')(Math.round(Number(d.hue)))},
                    { title: 'Radius', value: d3.format(',d')(Math.round(Number(d.radius)))}
                ]
            };
        };

        var circleSel = nodeLayer.selectAll('circle').data(nodes);


        circleSel.enter()
                .append('circle')
                .attr('name', function(d) { return d.name; })
                .attr("cx", function(d){ return d.cx; })
                .attr("cy", function(d){ return d.cy; })
                .attr("r", function(d){ return d.radius; })
                .attr("fill", function(d) { return "hsl(" + d.hue + ", 100%, 75%)" })
                .style("stroke", function(d) { return "hsl(" + d.hue + ", 100%, 50%)" })
                .style("stroke-width", 1)
                .style('opacity', function(d){ return d.alpha; })
        ;

        var voronoiSel = voronoiLayer.selectAll("path")
                .data(nodes);

        var showVoronoi = true;

        function toggleVoronoi(){
            showVoronoi = !showVoronoi;
            var vis = showVoronoi ? 'visible' : 'hidden';
            voronoiSel.style('visibility', vis);
        }

        voronoiSel
                .enter()
                .append("path")
                .style("fill", 'rgb(100,200,255)')
                .style('fill-opacity',.25)
                .style('stroke', 'rgb(80,220,240')
                .style('stroke-opacity',1)
                .style('visibility','visible')
                .style('pointer-events','all')
                .call(d3.kodama.tooltip()
                        .format(makeTipData))
                .on('mouseover', function(d){
                    var node = d;
                    d3.select(this).style('fill-opacity',.85).style('fill', 'rgb(230,240,255)');
                    circleSel.filter(function(d){ return d.name === node.name;})
                            .style('opacity',.8 )
                            .attr('r', function(d) { return d.radius * 2.5; })
                })
                .on('mouseout', function(d){

                    var node = d;
                    d3.select(this).style('fill-opacity',.25).style('fill', 'rgb(100,200,255)');
                    circleSel.filter(function(d){ return d.name === node.name;})
                            .transition().duration(1000)
                            .style('opacity', function(d){ return d.alpha})
                            .attr('r', function(d) { return d.radius; });
                })
                //.on('click', toggleVoronoi)
        ;

        voronoiSel
                .attr("d", function(d, i) {
                    return "M" + d.voronoiData.join("L") + "Z";
                });

        voronoiSel.exit().remove();



    });

</script>

</body></html>
